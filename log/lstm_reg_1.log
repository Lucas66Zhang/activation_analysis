2023-12-15 20:26:02,084 - root - INFO - Random seed: 1
2023-12-15 20:26:02,084 - root - INFO - Loading data...
2023-12-15 20:26:02,109 - root - INFO - shape of x_maxpool2: torch.Size([78800, 256])
2023-12-15 20:26:02,109 - root - INFO - shape of x_fc1: torch.Size([78800, 120])
2023-12-15 20:26:02,109 - root - INFO - shape of x_fc2: torch.Size([78800, 84])
2023-12-15 20:26:02,109 - root - INFO - shape of x_fc3: torch.Size([78800, 10])
2023-12-15 20:26:02,109 - root - INFO - data loading finished.
2023-12-15 20:26:02,109 - root - INFO - Spliting dataset...
2023-12-15 20:26:02,112 - root - INFO - train dataset size: 50432
2023-12-15 20:26:02,112 - root - INFO - val dataset size: 12608
2023-12-15 20:26:02,112 - root - INFO - test dataset size: 15760
2023-12-15 20:26:02,112 - root - INFO - dataset spliting finished.
2023-12-15 20:26:02,112 - root - INFO - Initializing model, optimizer and loss function...
2023-12-15 20:26:02,265 - root - INFO - model, optimizer and loss function initialization finished.
2023-12-15 20:26:02,265 - root - INFO - Start training...
  0%|                                                                        | 0/45 [00:00<?, ?it/s]Epoch: 1 | Train Loss: 0.0852 | Val Loss: 0.0921:   0%|                      | 0/45 [00:10<?, ?it/s]Epoch: 1 | Train Loss: 0.0852 | Val Loss: 0.0921:   2%|▎             | 1/45 [00:10<08:03, 10.99s/it]Epoch: 2 | Train Loss: 0.0425 | Val Loss: 0.0467:   2%|▎             | 1/45 [00:21<08:03, 10.99s/it]Epoch: 2 | Train Loss: 0.0425 | Val Loss: 0.0467:   4%|▌             | 2/45 [00:21<07:42, 10.75s/it]Epoch: 3 | Train Loss: 0.0361 | Val Loss: 0.0408:   4%|▌             | 2/45 [00:31<07:42, 10.75s/it]Epoch: 3 | Train Loss: 0.0361 | Val Loss: 0.0408:   7%|▉             | 3/45 [00:31<07:23, 10.56s/it]Epoch: 4 | Train Loss: 0.0312 | Val Loss: 0.0375:   7%|▉             | 3/45 [00:41<07:23, 10.56s/it]Epoch: 4 | Train Loss: 0.0312 | Val Loss: 0.0375:   9%|█▏            | 4/45 [00:41<07:04, 10.35s/it]Epoch: 5 | Train Loss: 0.0280 | Val Loss: 0.0347:   9%|█▏            | 4/45 [00:52<07:04, 10.35s/it]Epoch: 5 | Train Loss: 0.0280 | Val Loss: 0.0347:  11%|█▌            | 5/45 [00:52<06:50, 10.26s/it]Epoch: 6 | Train Loss: 0.0243 | Val Loss: 0.0319:  11%|█▌            | 5/45 [01:02<06:50, 10.26s/it]Epoch: 6 | Train Loss: 0.0243 | Val Loss: 0.0319:  13%|█▊            | 6/45 [01:02<06:37, 10.20s/it]Epoch: 7 | Train Loss: 0.0224 | Val Loss: 0.0303:  13%|█▊            | 6/45 [01:12<06:37, 10.20s/it]Epoch: 7 | Train Loss: 0.0224 | Val Loss: 0.0303:  16%|██▏           | 7/45 [01:12<06:25, 10.15s/it]Epoch: 8 | Train Loss: 0.0216 | Val Loss: 0.0301:  16%|██▏           | 7/45 [01:22<06:25, 10.15s/it]Epoch: 8 | Train Loss: 0.0216 | Val Loss: 0.0301:  18%|██▍           | 8/45 [01:22<06:14, 10.12s/it]Epoch: 9 | Train Loss: 0.0191 | Val Loss: 0.0282:  18%|██▍           | 8/45 [01:32<06:14, 10.12s/it]Epoch: 9 | Train Loss: 0.0191 | Val Loss: 0.0282:  20%|██▊           | 9/45 [01:32<06:01, 10.05s/it]Epoch: 10 | Train Loss: 0.0183 | Val Loss: 0.0272:  20%|██▌          | 9/45 [01:42<06:01, 10.05s/it]Epoch: 10 | Train Loss: 0.0183 | Val Loss: 0.0272:  22%|██▋         | 10/45 [01:42<05:51, 10.04s/it]Epoch: 11 | Train Loss: 0.0174 | Val Loss: 0.0273:  22%|██▋         | 10/45 [01:52<05:51, 10.04s/it]Epoch: 11 | Train Loss: 0.0174 | Val Loss: 0.0273:  24%|██▉         | 11/45 [01:52<05:42, 10.08s/it]Epoch: 12 | Train Loss: 0.0161 | Val Loss: 0.0261:  24%|██▉         | 11/45 [02:02<05:42, 10.08s/it]Epoch: 12 | Train Loss: 0.0161 | Val Loss: 0.0261:  27%|███▏        | 12/45 [02:02<05:31, 10.05s/it]Epoch: 13 | Train Loss: 0.0142 | Val Loss: 0.0248:  27%|███▏        | 12/45 [02:12<05:31, 10.05s/it]Epoch: 13 | Train Loss: 0.0142 | Val Loss: 0.0248:  29%|███▍        | 13/45 [02:12<05:21, 10.03s/it]Epoch: 14 | Train Loss: 0.0142 | Val Loss: 0.0251:  29%|███▍        | 13/45 [02:22<05:21, 10.03s/it]Epoch: 14 | Train Loss: 0.0142 | Val Loss: 0.0251:  31%|███▋        | 14/45 [02:22<05:10, 10.00s/it]Epoch: 15 | Train Loss: 0.0123 | Val Loss: 0.0235:  31%|███▋        | 14/45 [02:32<05:10, 10.00s/it]Epoch: 15 | Train Loss: 0.0123 | Val Loss: 0.0235:  33%|████        | 15/45 [02:32<05:00, 10.03s/it]Epoch: 16 | Train Loss: 0.0121 | Val Loss: 0.0236:  33%|████        | 15/45 [02:42<05:00, 10.03s/it]Epoch: 16 | Train Loss: 0.0121 | Val Loss: 0.0236:  36%|████▎       | 16/45 [02:42<04:50, 10.02s/it]Epoch: 17 | Train Loss: 0.0109 | Val Loss: 0.0228:  36%|████▎       | 16/45 [02:52<04:50, 10.02s/it]Epoch: 17 | Train Loss: 0.0109 | Val Loss: 0.0228:  38%|████▌       | 17/45 [02:52<04:39,  9.97s/it]Epoch: 18 | Train Loss: 0.0110 | Val Loss: 0.0232:  38%|████▌       | 17/45 [03:02<04:39,  9.97s/it]Epoch: 18 | Train Loss: 0.0110 | Val Loss: 0.0232:  40%|████▊       | 18/45 [03:02<04:28,  9.95s/it]Epoch: 19 | Train Loss: 0.0093 | Val Loss: 0.0219:  40%|████▊       | 18/45 [03:11<04:28,  9.95s/it]Epoch: 19 | Train Loss: 0.0093 | Val Loss: 0.0219:  42%|█████       | 19/45 [03:11<04:18,  9.94s/it]Epoch: 20 | Train Loss: 0.0087 | Val Loss: 0.0217:  42%|█████       | 19/45 [03:22<04:18,  9.94s/it]Epoch: 20 | Train Loss: 0.0087 | Val Loss: 0.0217:  44%|█████▎      | 20/45 [03:22<04:09,  9.99s/it]Epoch: 21 | Train Loss: 0.0082 | Val Loss: 0.0210:  44%|█████▎      | 20/45 [03:32<04:09,  9.99s/it]Epoch: 21 | Train Loss: 0.0082 | Val Loss: 0.0210:  47%|█████▌      | 21/45 [03:32<04:00, 10.01s/it]Epoch: 22 | Train Loss: 0.0084 | Val Loss: 0.0217:  47%|█████▌      | 21/45 [03:42<04:00, 10.01s/it]Epoch: 22 | Train Loss: 0.0084 | Val Loss: 0.0217:  49%|█████▊      | 22/45 [03:42<03:50, 10.01s/it]Epoch: 23 | Train Loss: 0.0079 | Val Loss: 0.0212:  49%|█████▊      | 22/45 [03:52<03:50, 10.01s/it]Epoch: 23 | Train Loss: 0.0079 | Val Loss: 0.0212:  51%|██████▏     | 23/45 [03:52<03:39,  9.99s/it]Epoch: 24 | Train Loss: 0.0081 | Val Loss: 0.0218:  51%|██████▏     | 23/45 [04:02<03:39,  9.99s/it]Epoch: 24 | Train Loss: 0.0081 | Val Loss: 0.0218:  53%|██████▍     | 24/45 [04:02<03:29,  9.97s/it]Epoch: 25 | Train Loss: 0.0071 | Val Loss: 0.0209:  53%|██████▍     | 24/45 [04:11<03:29,  9.97s/it]Epoch: 25 | Train Loss: 0.0071 | Val Loss: 0.0209:  56%|██████▋     | 25/45 [04:11<03:19,  9.98s/it]Epoch: 26 | Train Loss: 0.0075 | Val Loss: 0.0213:  56%|██████▋     | 25/45 [04:22<03:19,  9.98s/it]Epoch: 26 | Train Loss: 0.0075 | Val Loss: 0.0213:  58%|██████▉     | 26/45 [04:22<03:09,  9.99s/it]Epoch: 27 | Train Loss: 0.0064 | Val Loss: 0.0203:  58%|██████▉     | 26/45 [04:32<03:09,  9.99s/it]Epoch: 27 | Train Loss: 0.0064 | Val Loss: 0.0203:  60%|███████▏    | 27/45 [04:32<03:00, 10.02s/it]Epoch: 28 | Train Loss: 0.0064 | Val Loss: 0.0206:  60%|███████▏    | 27/45 [04:42<03:00, 10.02s/it]Epoch: 28 | Train Loss: 0.0064 | Val Loss: 0.0206:  62%|███████▍    | 28/45 [04:42<02:50, 10.03s/it]Epoch: 29 | Train Loss: 0.0061 | Val Loss: 0.0201:  62%|███████▍    | 28/45 [04:52<02:50, 10.03s/it]Epoch: 29 | Train Loss: 0.0061 | Val Loss: 0.0201:  64%|███████▋    | 29/45 [04:52<02:40, 10.03s/it]Epoch: 30 | Train Loss: 0.0061 | Val Loss: 0.0204:  64%|███████▋    | 29/45 [05:02<02:40, 10.03s/it]Epoch: 30 | Train Loss: 0.0061 | Val Loss: 0.0204:  67%|████████    | 30/45 [05:02<02:30, 10.00s/it]Epoch: 31 | Train Loss: 0.0062 | Val Loss: 0.0210:  67%|████████    | 30/45 [05:12<02:30, 10.00s/it]Epoch: 31 | Train Loss: 0.0062 | Val Loss: 0.0210:  69%|████████▎   | 31/45 [05:12<02:20, 10.02s/it]Epoch: 32 | Train Loss: 0.0052 | Val Loss: 0.0200:  69%|████████▎   | 31/45 [05:22<02:20, 10.02s/it]Epoch: 32 | Train Loss: 0.0052 | Val Loss: 0.0200:  71%|████████▌   | 32/45 [05:22<02:10, 10.00s/it]Epoch: 33 | Train Loss: 0.0054 | Val Loss: 0.0201:  71%|████████▌   | 32/45 [05:32<02:10, 10.00s/it]Epoch: 33 | Train Loss: 0.0054 | Val Loss: 0.0201:  73%|████████▊   | 33/45 [05:32<01:59,  9.98s/it]Epoch: 34 | Train Loss: 0.0049 | Val Loss: 0.0195:  73%|████████▊   | 33/45 [05:42<01:59,  9.98s/it]Epoch: 34 | Train Loss: 0.0049 | Val Loss: 0.0195:  76%|█████████   | 34/45 [05:42<01:50, 10.03s/it]Epoch: 35 | Train Loss: 0.0054 | Val Loss: 0.0199:  76%|█████████   | 34/45 [05:52<01:50, 10.03s/it]Epoch: 35 | Train Loss: 0.0054 | Val Loss: 0.0199:  78%|█████████▎  | 35/45 [05:52<01:40, 10.02s/it]Epoch: 36 | Train Loss: 0.0049 | Val Loss: 0.0196:  78%|█████████▎  | 35/45 [06:02<01:40, 10.02s/it]Epoch: 36 | Train Loss: 0.0049 | Val Loss: 0.0196:  80%|█████████▌  | 36/45 [06:02<01:30, 10.01s/it]Epoch: 37 | Train Loss: 0.0045 | Val Loss: 0.0193:  80%|█████████▌  | 36/45 [06:12<01:30, 10.01s/it]Epoch: 37 | Train Loss: 0.0045 | Val Loss: 0.0193:  82%|█████████▊  | 37/45 [06:12<01:19,  9.99s/it]Epoch: 38 | Train Loss: 0.0045 | Val Loss: 0.0191:  82%|█████████▊  | 37/45 [06:22<01:19,  9.99s/it]Epoch: 38 | Train Loss: 0.0045 | Val Loss: 0.0191:  84%|██████████▏ | 38/45 [06:22<01:10, 10.01s/it]Epoch: 39 | Train Loss: 0.0045 | Val Loss: 0.0196:  84%|██████████▏ | 38/45 [06:32<01:10, 10.01s/it]Epoch: 39 | Train Loss: 0.0045 | Val Loss: 0.0196:  87%|██████████▍ | 39/45 [06:32<01:00, 10.03s/it]Epoch: 40 | Train Loss: 0.0039 | Val Loss: 0.0189:  87%|██████████▍ | 39/45 [06:42<01:00, 10.03s/it]Epoch: 40 | Train Loss: 0.0039 | Val Loss: 0.0189:  89%|██████████▋ | 40/45 [06:42<00:49, 10.00s/it]Epoch: 41 | Train Loss: 0.0040 | Val Loss: 0.0193:  89%|██████████▋ | 40/45 [06:52<00:49, 10.00s/it]Epoch: 41 | Train Loss: 0.0040 | Val Loss: 0.0193:  91%|██████████▉ | 41/45 [06:52<00:40, 10.13s/it]Epoch: 42 | Train Loss: 0.0039 | Val Loss: 0.0188:  91%|██████████▉ | 41/45 [07:02<00:40, 10.13s/it]Epoch: 42 | Train Loss: 0.0039 | Val Loss: 0.0188:  93%|███████████▏| 42/45 [07:02<00:30, 10.20s/it]Epoch: 43 | Train Loss: 0.0036 | Val Loss: 0.0190:  93%|███████████▏| 42/45 [07:13<00:30, 10.20s/it]Epoch: 43 | Train Loss: 0.0036 | Val Loss: 0.0190:  96%|███████████▍| 43/45 [07:13<00:20, 10.19s/it]Epoch: 44 | Train Loss: 0.0040 | Val Loss: 0.0190:  96%|███████████▍| 43/45 [07:23<00:20, 10.19s/it]Epoch: 44 | Train Loss: 0.0040 | Val Loss: 0.0190:  98%|███████████▋| 44/45 [07:23<00:10, 10.19s/it]Epoch: 45 | Train Loss: 0.0034 | Val Loss: 0.0185:  98%|███████████▋| 44/45 [07:33<00:10, 10.19s/it]Epoch: 45 | Train Loss: 0.0034 | Val Loss: 0.0185: 100%|████████████| 45/45 [07:33<00:00, 10.18s/it]Epoch: 45 | Train Loss: 0.0034 | Val Loss: 0.0185: 100%|████████████| 45/45 [07:33<00:00, 10.08s/it]
2023-12-15 20:33:35,820 - root - INFO - Training finished.
2023-12-15 20:33:35,821 - root - INFO - Testing model...
2023-12-15 20:33:36,220 - root - INFO - Test loss: 0.018706611124798656, Test r_square: 0.773377537727356
2023-12-15 20:33:36,220 - root - INFO - Testing finished.
2023-12-15 20:33:36,220 - root - INFO - saving model...
2023-12-15 20:33:36,244 - root - INFO - model saved.
2023-12-15 20:33:36,244 - root - INFO - saving results
2023-12-15 20:33:36,247 - root - INFO - results saved.
