2023-12-15 20:33:37,611 - root - INFO - Random seed: 2
2023-12-15 20:33:37,611 - root - INFO - Loading data...
2023-12-15 20:33:37,641 - root - INFO - shape of x_maxpool2: torch.Size([78800, 256])
2023-12-15 20:33:37,641 - root - INFO - shape of x_fc1: torch.Size([78800, 120])
2023-12-15 20:33:37,641 - root - INFO - shape of x_fc2: torch.Size([78800, 84])
2023-12-15 20:33:37,641 - root - INFO - shape of x_fc3: torch.Size([78800, 10])
2023-12-15 20:33:37,641 - root - INFO - data loading finished.
2023-12-15 20:33:37,641 - root - INFO - Spliting dataset...
2023-12-15 20:33:37,644 - root - INFO - train dataset size: 50432
2023-12-15 20:33:37,644 - root - INFO - val dataset size: 12608
2023-12-15 20:33:37,644 - root - INFO - test dataset size: 15760
2023-12-15 20:33:37,644 - root - INFO - dataset spliting finished.
2023-12-15 20:33:37,644 - root - INFO - Initializing model, optimizer and loss function...
2023-12-15 20:33:37,825 - root - INFO - model, optimizer and loss function initialization finished.
2023-12-15 20:33:37,825 - root - INFO - Start training...
  0%|                                                                        | 0/45 [00:00<?, ?it/s]Epoch: 1 | Train Loss: 0.0750 | Val Loss: 0.0831:   0%|                      | 0/45 [00:10<?, ?it/s]Epoch: 1 | Train Loss: 0.0750 | Val Loss: 0.0831:   2%|▎             | 1/45 [00:10<07:41, 10.50s/it]Epoch: 2 | Train Loss: 0.0427 | Val Loss: 0.0463:   2%|▎             | 1/45 [00:20<07:41, 10.50s/it]Epoch: 2 | Train Loss: 0.0427 | Val Loss: 0.0463:   4%|▌             | 2/45 [00:20<07:19, 10.22s/it]Epoch: 3 | Train Loss: 0.0359 | Val Loss: 0.0409:   4%|▌             | 2/45 [00:30<07:19, 10.22s/it]Epoch: 3 | Train Loss: 0.0359 | Val Loss: 0.0409:   7%|▉             | 3/45 [00:30<07:04, 10.12s/it]Epoch: 4 | Train Loss: 0.0324 | Val Loss: 0.0383:   7%|▉             | 3/45 [00:40<07:04, 10.12s/it]Epoch: 4 | Train Loss: 0.0324 | Val Loss: 0.0383:   9%|█▏            | 4/45 [00:40<06:52, 10.05s/it]Epoch: 5 | Train Loss: 0.0279 | Val Loss: 0.0354:   9%|█▏            | 4/45 [00:50<06:52, 10.05s/it]Epoch: 5 | Train Loss: 0.0279 | Val Loss: 0.0354:  11%|█▌            | 5/45 [00:50<06:42, 10.06s/it]Epoch: 6 | Train Loss: 0.0248 | Val Loss: 0.0325:  11%|█▌            | 5/45 [01:00<06:42, 10.06s/it]Epoch: 6 | Train Loss: 0.0248 | Val Loss: 0.0325:  13%|█▊            | 6/45 [01:00<06:31, 10.05s/it]Epoch: 7 | Train Loss: 0.0235 | Val Loss: 0.0318:  13%|█▊            | 6/45 [01:10<06:31, 10.05s/it]Epoch: 7 | Train Loss: 0.0235 | Val Loss: 0.0318:  16%|██▏           | 7/45 [01:10<06:21, 10.03s/it]Epoch: 8 | Train Loss: 0.0208 | Val Loss: 0.0297:  16%|██▏           | 7/45 [01:20<06:21, 10.03s/it]Epoch: 8 | Train Loss: 0.0208 | Val Loss: 0.0297:  18%|██▍           | 8/45 [01:20<06:10, 10.01s/it]Epoch: 9 | Train Loss: 0.0187 | Val Loss: 0.0281:  18%|██▍           | 8/45 [01:30<06:10, 10.01s/it]Epoch: 9 | Train Loss: 0.0187 | Val Loss: 0.0281:  20%|██▊           | 9/45 [01:30<06:00, 10.00s/it]Epoch: 10 | Train Loss: 0.0173 | Val Loss: 0.0269:  20%|██▌          | 9/45 [01:40<06:00, 10.00s/it]Epoch: 10 | Train Loss: 0.0173 | Val Loss: 0.0269:  22%|██▋         | 10/45 [01:40<05:49, 10.00s/it]Epoch: 11 | Train Loss: 0.0163 | Val Loss: 0.0266:  22%|██▋         | 10/45 [01:50<05:49, 10.00s/it]Epoch: 11 | Train Loss: 0.0163 | Val Loss: 0.0266:  24%|██▉         | 11/45 [01:50<05:40, 10.02s/it]Epoch: 12 | Train Loss: 0.0154 | Val Loss: 0.0258:  24%|██▉         | 11/45 [02:00<05:40, 10.02s/it]Epoch: 12 | Train Loss: 0.0154 | Val Loss: 0.0258:  27%|███▏        | 12/45 [02:00<05:30, 10.02s/it]Epoch: 13 | Train Loss: 0.0145 | Val Loss: 0.0256:  27%|███▏        | 12/45 [02:10<05:30, 10.02s/it]Epoch: 13 | Train Loss: 0.0145 | Val Loss: 0.0256:  29%|███▍        | 13/45 [02:10<05:21, 10.04s/it]Epoch: 14 | Train Loss: 0.0135 | Val Loss: 0.0249:  29%|███▍        | 13/45 [02:20<05:21, 10.04s/it]Epoch: 14 | Train Loss: 0.0135 | Val Loss: 0.0249:  31%|███▋        | 14/45 [02:20<05:10, 10.01s/it]Epoch: 15 | Train Loss: 0.0131 | Val Loss: 0.0251:  31%|███▋        | 14/45 [02:30<05:10, 10.01s/it]Epoch: 15 | Train Loss: 0.0131 | Val Loss: 0.0251:  33%|████        | 15/45 [02:30<05:00, 10.00s/it]Epoch: 16 | Train Loss: 0.0117 | Val Loss: 0.0235:  33%|████        | 15/45 [02:40<05:00, 10.00s/it]Epoch: 16 | Train Loss: 0.0117 | Val Loss: 0.0235:  36%|████▎       | 16/45 [02:40<04:49,  9.98s/it]Epoch: 17 | Train Loss: 0.0117 | Val Loss: 0.0241:  36%|████▎       | 16/45 [02:50<04:49,  9.98s/it]Epoch: 17 | Train Loss: 0.0117 | Val Loss: 0.0241:  38%|████▌       | 17/45 [02:50<04:39,  9.99s/it]Epoch: 18 | Train Loss: 0.0102 | Val Loss: 0.0231:  38%|████▌       | 17/45 [03:00<04:39,  9.99s/it]Epoch: 18 | Train Loss: 0.0102 | Val Loss: 0.0231:  40%|████▊       | 18/45 [03:00<04:30, 10.01s/it]Epoch: 19 | Train Loss: 0.0105 | Val Loss: 0.0235:  40%|████▊       | 18/45 [03:10<04:30, 10.01s/it]Epoch: 19 | Train Loss: 0.0105 | Val Loss: 0.0235:  42%|█████       | 19/45 [03:10<04:21, 10.05s/it]Epoch: 20 | Train Loss: 0.0091 | Val Loss: 0.0225:  42%|█████       | 19/45 [03:20<04:21, 10.05s/it]Epoch: 20 | Train Loss: 0.0091 | Val Loss: 0.0225:  44%|█████▎      | 20/45 [03:20<04:11, 10.05s/it]Epoch: 21 | Train Loss: 0.0090 | Val Loss: 0.0221:  44%|█████▎      | 20/45 [03:30<04:11, 10.05s/it]Epoch: 21 | Train Loss: 0.0090 | Val Loss: 0.0221:  47%|█████▌      | 21/45 [03:30<04:00, 10.01s/it]Epoch: 22 | Train Loss: 0.0086 | Val Loss: 0.0220:  47%|█████▌      | 21/45 [03:40<04:00, 10.01s/it]Epoch: 22 | Train Loss: 0.0086 | Val Loss: 0.0220:  49%|█████▊      | 22/45 [03:40<03:50, 10.03s/it]Epoch: 23 | Train Loss: 0.0084 | Val Loss: 0.0223:  49%|█████▊      | 22/45 [03:50<03:50, 10.03s/it]Epoch: 23 | Train Loss: 0.0084 | Val Loss: 0.0223:  51%|██████▏     | 23/45 [03:50<03:40, 10.01s/it]Epoch: 24 | Train Loss: 0.0079 | Val Loss: 0.0218:  51%|██████▏     | 23/45 [04:00<03:40, 10.01s/it]Epoch: 24 | Train Loss: 0.0079 | Val Loss: 0.0218:  53%|██████▍     | 24/45 [04:00<03:30, 10.03s/it]Epoch: 25 | Train Loss: 0.0083 | Val Loss: 0.0223:  53%|██████▍     | 24/45 [04:10<03:30, 10.03s/it]Epoch: 25 | Train Loss: 0.0083 | Val Loss: 0.0223:  56%|██████▋     | 25/45 [04:10<03:20, 10.05s/it]Epoch: 26 | Train Loss: 0.0070 | Val Loss: 0.0208:  56%|██████▋     | 25/45 [04:20<03:20, 10.05s/it]Epoch: 26 | Train Loss: 0.0070 | Val Loss: 0.0208:  58%|██████▉     | 26/45 [04:20<03:10, 10.04s/it]Epoch: 27 | Train Loss: 0.0073 | Val Loss: 0.0213:  58%|██████▉     | 26/45 [04:31<03:10, 10.04s/it]Epoch: 27 | Train Loss: 0.0073 | Val Loss: 0.0213:  60%|███████▏    | 27/45 [04:31<03:00, 10.05s/it]Epoch: 28 | Train Loss: 0.0071 | Val Loss: 0.0214:  60%|███████▏    | 27/45 [04:40<03:00, 10.05s/it]Epoch: 28 | Train Loss: 0.0071 | Val Loss: 0.0214:  62%|███████▍    | 28/45 [04:40<02:50, 10.02s/it]Epoch: 29 | Train Loss: 0.0064 | Val Loss: 0.0210:  62%|███████▍    | 28/45 [04:50<02:50, 10.02s/it]Epoch: 29 | Train Loss: 0.0064 | Val Loss: 0.0210:  64%|███████▋    | 29/45 [04:50<02:40, 10.03s/it]Epoch: 30 | Train Loss: 0.0059 | Val Loss: 0.0202:  64%|███████▋    | 29/45 [05:01<02:40, 10.03s/it]Epoch: 30 | Train Loss: 0.0059 | Val Loss: 0.0202:  67%|████████    | 30/45 [05:01<02:30, 10.02s/it]Epoch: 31 | Train Loss: 0.0058 | Val Loss: 0.0207:  67%|████████    | 30/45 [05:10<02:30, 10.02s/it]Epoch: 31 | Train Loss: 0.0058 | Val Loss: 0.0207:  69%|████████▎   | 31/45 [05:10<02:19,  9.99s/it]Epoch: 32 | Train Loss: 0.0056 | Val Loss: 0.0207:  69%|████████▎   | 31/45 [05:20<02:19,  9.99s/it]Epoch: 32 | Train Loss: 0.0056 | Val Loss: 0.0207:  71%|████████▌   | 32/45 [05:20<02:10, 10.01s/it]Epoch: 33 | Train Loss: 0.0062 | Val Loss: 0.0208:  71%|████████▌   | 32/45 [05:31<02:10, 10.01s/it]Epoch: 33 | Train Loss: 0.0062 | Val Loss: 0.0208:  73%|████████▊   | 33/45 [05:31<02:00, 10.02s/it]Epoch: 34 | Train Loss: 0.0052 | Val Loss: 0.0201:  73%|████████▊   | 33/45 [05:41<02:00, 10.02s/it]Epoch: 34 | Train Loss: 0.0052 | Val Loss: 0.0201:  76%|█████████   | 34/45 [05:41<01:50, 10.06s/it]Epoch: 35 | Train Loss: 0.0051 | Val Loss: 0.0200:  76%|█████████   | 34/45 [05:51<01:50, 10.06s/it]Epoch: 35 | Train Loss: 0.0051 | Val Loss: 0.0200:  78%|█████████▎  | 35/45 [05:51<01:40, 10.02s/it]Epoch: 36 | Train Loss: 0.0046 | Val Loss: 0.0198:  78%|█████████▎  | 35/45 [06:01<01:40, 10.02s/it]Epoch: 36 | Train Loss: 0.0046 | Val Loss: 0.0198:  80%|█████████▌  | 36/45 [06:01<01:30, 10.02s/it]Epoch: 37 | Train Loss: 0.0046 | Val Loss: 0.0201:  80%|█████████▌  | 36/45 [06:11<01:30, 10.02s/it]Epoch: 37 | Train Loss: 0.0046 | Val Loss: 0.0201:  82%|█████████▊  | 37/45 [06:11<01:20, 10.05s/it]Epoch: 38 | Train Loss: 0.0044 | Val Loss: 0.0194:  82%|█████████▊  | 37/45 [06:21<01:20, 10.05s/it]Epoch: 38 | Train Loss: 0.0044 | Val Loss: 0.0194:  84%|██████████▏ | 38/45 [06:21<01:10, 10.04s/it]Epoch: 39 | Train Loss: 0.0046 | Val Loss: 0.0200:  84%|██████████▏ | 38/45 [06:31<01:10, 10.04s/it]Epoch: 39 | Train Loss: 0.0046 | Val Loss: 0.0200:  87%|██████████▍ | 39/45 [06:31<01:00, 10.05s/it]Epoch: 40 | Train Loss: 0.0044 | Val Loss: 0.0202:  87%|██████████▍ | 39/45 [06:41<01:00, 10.05s/it]Epoch: 40 | Train Loss: 0.0044 | Val Loss: 0.0202:  89%|██████████▋ | 40/45 [06:41<00:50, 10.06s/it]Epoch: 41 | Train Loss: 0.0042 | Val Loss: 0.0196:  89%|██████████▋ | 40/45 [06:51<00:50, 10.06s/it]Epoch: 41 | Train Loss: 0.0042 | Val Loss: 0.0196:  91%|██████████▉ | 41/45 [06:51<00:40, 10.06s/it]Epoch: 42 | Train Loss: 0.0036 | Val Loss: 0.0193:  91%|██████████▉ | 41/45 [07:01<00:40, 10.06s/it]Epoch: 42 | Train Loss: 0.0036 | Val Loss: 0.0193:  93%|███████████▏| 42/45 [07:01<00:30, 10.07s/it]Epoch: 43 | Train Loss: 0.0038 | Val Loss: 0.0194:  93%|███████████▏| 42/45 [07:11<00:30, 10.07s/it]Epoch: 43 | Train Loss: 0.0038 | Val Loss: 0.0194:  96%|███████████▍| 43/45 [07:11<00:20, 10.11s/it]Epoch: 44 | Train Loss: 0.0037 | Val Loss: 0.0195:  96%|███████████▍| 43/45 [07:21<00:20, 10.11s/it]Epoch: 44 | Train Loss: 0.0037 | Val Loss: 0.0195:  98%|███████████▋| 44/45 [07:21<00:10, 10.14s/it]Epoch: 45 | Train Loss: 0.0043 | Val Loss: 0.0198:  98%|███████████▋| 44/45 [07:32<00:10, 10.14s/it]Epoch: 45 | Train Loss: 0.0043 | Val Loss: 0.0198: 100%|████████████| 45/45 [07:32<00:00, 10.16s/it]Epoch: 45 | Train Loss: 0.0043 | Val Loss: 0.0198: 100%|████████████| 45/45 [07:32<00:00, 10.05s/it]
2023-12-15 20:41:10,033 - root - INFO - Training finished.
2023-12-15 20:41:10,033 - root - INFO - Testing model...
2023-12-15 20:41:10,488 - root - INFO - Test loss: 0.020112363970838487, Test r_square: 0.7549435347318649
2023-12-15 20:41:10,488 - root - INFO - Testing finished.
2023-12-15 20:41:10,488 - root - INFO - saving model...
2023-12-15 20:41:10,515 - root - INFO - model saved.
2023-12-15 20:41:10,515 - root - INFO - saving results
2023-12-15 20:41:10,517 - root - INFO - results saved.
