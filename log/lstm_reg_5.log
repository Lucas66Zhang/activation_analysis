2023-12-15 20:56:22,413 - root - INFO - Random seed: 5
2023-12-15 20:56:22,413 - root - INFO - Loading data...
2023-12-15 20:56:22,444 - root - INFO - shape of x_maxpool2: torch.Size([78800, 256])
2023-12-15 20:56:22,444 - root - INFO - shape of x_fc1: torch.Size([78800, 120])
2023-12-15 20:56:22,444 - root - INFO - shape of x_fc2: torch.Size([78800, 84])
2023-12-15 20:56:22,444 - root - INFO - shape of x_fc3: torch.Size([78800, 10])
2023-12-15 20:56:22,445 - root - INFO - data loading finished.
2023-12-15 20:56:22,445 - root - INFO - Spliting dataset...
2023-12-15 20:56:22,447 - root - INFO - train dataset size: 50432
2023-12-15 20:56:22,447 - root - INFO - val dataset size: 12608
2023-12-15 20:56:22,447 - root - INFO - test dataset size: 15760
2023-12-15 20:56:22,447 - root - INFO - dataset spliting finished.
2023-12-15 20:56:22,447 - root - INFO - Initializing model, optimizer and loss function...
2023-12-15 20:56:22,623 - root - INFO - model, optimizer and loss function initialization finished.
2023-12-15 20:56:22,623 - root - INFO - Start training...
  0%|                                                                        | 0/45 [00:00<?, ?it/s]Epoch: 1 | Train Loss: 0.0710 | Val Loss: 0.0780:   0%|                      | 0/45 [00:10<?, ?it/s]Epoch: 1 | Train Loss: 0.0710 | Val Loss: 0.0780:   2%|▎             | 1/45 [00:10<07:33, 10.31s/it]Epoch: 2 | Train Loss: 0.0433 | Val Loss: 0.0481:   2%|▎             | 1/45 [00:20<07:33, 10.31s/it]Epoch: 2 | Train Loss: 0.0433 | Val Loss: 0.0481:   4%|▌             | 2/45 [00:20<07:12, 10.07s/it]Epoch: 3 | Train Loss: 0.0371 | Val Loss: 0.0430:   4%|▌             | 2/45 [00:30<07:12, 10.07s/it]Epoch: 3 | Train Loss: 0.0371 | Val Loss: 0.0430:   7%|▉             | 3/45 [00:30<06:58,  9.97s/it]Epoch: 4 | Train Loss: 0.0326 | Val Loss: 0.0384:   7%|▉             | 3/45 [00:39<06:58,  9.97s/it]Epoch: 4 | Train Loss: 0.0326 | Val Loss: 0.0384:   9%|█▏            | 4/45 [00:39<06:46,  9.90s/it]Epoch: 5 | Train Loss: 0.0261 | Val Loss: 0.0335:   9%|█▏            | 4/45 [00:49<06:46,  9.90s/it]Epoch: 5 | Train Loss: 0.0261 | Val Loss: 0.0335:  11%|█▌            | 5/45 [00:49<06:36,  9.91s/it]Epoch: 6 | Train Loss: 0.0259 | Val Loss: 0.0334:  11%|█▌            | 5/45 [00:59<06:36,  9.91s/it]Epoch: 6 | Train Loss: 0.0259 | Val Loss: 0.0334:  13%|█▊            | 6/45 [00:59<06:28,  9.97s/it]Epoch: 7 | Train Loss: 0.0213 | Val Loss: 0.0295:  13%|█▊            | 6/45 [01:09<06:28,  9.97s/it]Epoch: 7 | Train Loss: 0.0213 | Val Loss: 0.0295:  16%|██▏           | 7/45 [01:09<06:19,  9.98s/it]Epoch: 8 | Train Loss: 0.0200 | Val Loss: 0.0290:  16%|██▏           | 7/45 [01:19<06:19,  9.98s/it]Epoch: 8 | Train Loss: 0.0200 | Val Loss: 0.0290:  18%|██▍           | 8/45 [01:19<06:09,  9.98s/it]Epoch: 9 | Train Loss: 0.0186 | Val Loss: 0.0278:  18%|██▍           | 8/45 [01:29<06:09,  9.98s/it]Epoch: 9 | Train Loss: 0.0186 | Val Loss: 0.0278:  20%|██▊           | 9/45 [01:29<06:00, 10.02s/it]Epoch: 10 | Train Loss: 0.0182 | Val Loss: 0.0276:  20%|██▌          | 9/45 [01:40<06:00, 10.02s/it]Epoch: 10 | Train Loss: 0.0182 | Val Loss: 0.0276:  22%|██▋         | 10/45 [01:40<05:52, 10.07s/it]Epoch: 11 | Train Loss: 0.0161 | Val Loss: 0.0259:  22%|██▋         | 10/45 [01:50<05:52, 10.07s/it]Epoch: 11 | Train Loss: 0.0161 | Val Loss: 0.0259:  24%|██▉         | 11/45 [01:50<05:41, 10.03s/it]Epoch: 12 | Train Loss: 0.0152 | Val Loss: 0.0257:  24%|██▉         | 11/45 [02:00<05:41, 10.03s/it]Epoch: 12 | Train Loss: 0.0152 | Val Loss: 0.0257:  27%|███▏        | 12/45 [02:00<05:31, 10.03s/it]Epoch: 13 | Train Loss: 0.0147 | Val Loss: 0.0258:  27%|███▏        | 12/45 [02:10<05:31, 10.03s/it]Epoch: 13 | Train Loss: 0.0147 | Val Loss: 0.0258:  29%|███▍        | 13/45 [02:10<05:21, 10.05s/it]Epoch: 14 | Train Loss: 0.0147 | Val Loss: 0.0265:  29%|███▍        | 13/45 [02:20<05:21, 10.05s/it]Epoch: 14 | Train Loss: 0.0147 | Val Loss: 0.0265:  31%|███▋        | 14/45 [02:20<05:12, 10.07s/it]Epoch: 15 | Train Loss: 0.0128 | Val Loss: 0.0241:  31%|███▋        | 14/45 [02:30<05:12, 10.07s/it]Epoch: 15 | Train Loss: 0.0128 | Val Loss: 0.0241:  33%|████        | 15/45 [02:30<05:03, 10.11s/it]Epoch: 16 | Train Loss: 0.0115 | Val Loss: 0.0237:  33%|████        | 15/45 [02:40<05:03, 10.11s/it]Epoch: 16 | Train Loss: 0.0115 | Val Loss: 0.0237:  36%|████▎       | 16/45 [02:40<04:53, 10.13s/it]Epoch: 17 | Train Loss: 0.0110 | Val Loss: 0.0235:  36%|████▎       | 16/45 [02:50<04:53, 10.13s/it]Epoch: 17 | Train Loss: 0.0110 | Val Loss: 0.0235:  38%|████▌       | 17/45 [02:50<04:43, 10.12s/it]Epoch: 18 | Train Loss: 0.0098 | Val Loss: 0.0224:  38%|████▌       | 17/45 [03:01<04:43, 10.12s/it]Epoch: 18 | Train Loss: 0.0098 | Val Loss: 0.0224:  40%|████▊       | 18/45 [03:01<04:33, 10.14s/it]Epoch: 19 | Train Loss: 0.0110 | Val Loss: 0.0238:  40%|████▊       | 18/45 [03:11<04:33, 10.14s/it]Epoch: 19 | Train Loss: 0.0110 | Val Loss: 0.0238:  42%|█████       | 19/45 [03:11<04:23, 10.14s/it]Epoch: 20 | Train Loss: 0.0096 | Val Loss: 0.0227:  42%|█████       | 19/45 [03:21<04:23, 10.14s/it]Epoch: 20 | Train Loss: 0.0096 | Val Loss: 0.0227:  44%|█████▎      | 20/45 [03:21<04:11, 10.08s/it]Epoch: 21 | Train Loss: 0.0094 | Val Loss: 0.0225:  44%|█████▎      | 20/45 [03:31<04:11, 10.08s/it]Epoch: 21 | Train Loss: 0.0094 | Val Loss: 0.0225:  47%|█████▌      | 21/45 [03:31<04:00, 10.04s/it]Epoch: 22 | Train Loss: 0.0082 | Val Loss: 0.0216:  47%|█████▌      | 21/45 [03:40<04:00, 10.04s/it]Epoch: 22 | Train Loss: 0.0082 | Val Loss: 0.0216:  49%|█████▊      | 22/45 [03:40<03:49, 10.00s/it]Epoch: 23 | Train Loss: 0.0078 | Val Loss: 0.0217:  49%|█████▊      | 22/45 [03:50<03:49, 10.00s/it]Epoch: 23 | Train Loss: 0.0078 | Val Loss: 0.0217:  51%|██████▏     | 23/45 [03:50<03:39,  9.99s/it]Epoch: 24 | Train Loss: 0.0080 | Val Loss: 0.0219:  51%|██████▏     | 23/45 [04:00<03:39,  9.99s/it]Epoch: 24 | Train Loss: 0.0080 | Val Loss: 0.0219:  53%|██████▍     | 24/45 [04:00<03:29,  9.99s/it]Epoch: 25 | Train Loss: 0.0082 | Val Loss: 0.0217:  53%|██████▍     | 24/45 [04:10<03:29,  9.99s/it]Epoch: 25 | Train Loss: 0.0082 | Val Loss: 0.0217:  56%|██████▋     | 25/45 [04:10<03:19, 10.00s/it]Epoch: 26 | Train Loss: 0.0084 | Val Loss: 0.0225:  56%|██████▋     | 25/45 [04:20<03:19, 10.00s/it]Epoch: 26 | Train Loss: 0.0084 | Val Loss: 0.0225:  58%|██████▉     | 26/45 [04:20<03:10, 10.01s/it]Epoch: 27 | Train Loss: 0.0068 | Val Loss: 0.0209:  58%|██████▉     | 26/45 [04:31<03:10, 10.01s/it]Epoch: 27 | Train Loss: 0.0068 | Val Loss: 0.0209:  60%|███████▏    | 27/45 [04:31<03:00, 10.05s/it]Epoch: 28 | Train Loss: 0.0062 | Val Loss: 0.0207:  60%|███████▏    | 27/45 [04:41<03:00, 10.05s/it]Epoch: 28 | Train Loss: 0.0062 | Val Loss: 0.0207:  62%|███████▍    | 28/45 [04:41<02:50, 10.02s/it]Epoch: 29 | Train Loss: 0.0062 | Val Loss: 0.0208:  62%|███████▍    | 28/45 [04:51<02:50, 10.02s/it]Epoch: 29 | Train Loss: 0.0062 | Val Loss: 0.0208:  64%|███████▋    | 29/45 [04:51<02:40, 10.02s/it]Epoch: 30 | Train Loss: 0.0059 | Val Loss: 0.0208:  64%|███████▋    | 29/45 [05:01<02:40, 10.02s/it]Epoch: 30 | Train Loss: 0.0059 | Val Loss: 0.0208:  67%|████████    | 30/45 [05:01<02:30, 10.02s/it]Epoch: 31 | Train Loss: 0.0065 | Val Loss: 0.0213:  67%|████████    | 30/45 [05:11<02:30, 10.02s/it]Epoch: 31 | Train Loss: 0.0065 | Val Loss: 0.0213:  69%|████████▎   | 31/45 [05:11<02:20, 10.01s/it]Epoch: 32 | Train Loss: 0.0058 | Val Loss: 0.0210:  69%|████████▎   | 31/45 [05:21<02:20, 10.01s/it]Epoch: 32 | Train Loss: 0.0058 | Val Loss: 0.0210:  71%|████████▌   | 32/45 [05:21<02:10, 10.03s/it]Epoch: 33 | Train Loss: 0.0053 | Val Loss: 0.0204:  71%|████████▌   | 32/45 [05:31<02:10, 10.03s/it]Epoch: 33 | Train Loss: 0.0053 | Val Loss: 0.0204:  73%|████████▊   | 33/45 [05:31<02:00, 10.00s/it]Epoch: 34 | Train Loss: 0.0050 | Val Loss: 0.0202:  73%|████████▊   | 33/45 [05:41<02:00, 10.00s/it]Epoch: 34 | Train Loss: 0.0050 | Val Loss: 0.0202:  76%|█████████   | 34/45 [05:41<01:50, 10.01s/it]Epoch: 35 | Train Loss: 0.0045 | Val Loss: 0.0194:  76%|█████████   | 34/45 [05:51<01:50, 10.01s/it]Epoch: 35 | Train Loss: 0.0045 | Val Loss: 0.0194:  78%|█████████▎  | 35/45 [05:51<01:40, 10.01s/it]Epoch: 36 | Train Loss: 0.0050 | Val Loss: 0.0199:  78%|█████████▎  | 35/45 [06:00<01:40, 10.01s/it]Epoch: 36 | Train Loss: 0.0050 | Val Loss: 0.0199:  80%|█████████▌  | 36/45 [06:00<01:29,  9.96s/it]Epoch: 37 | Train Loss: 0.0044 | Val Loss: 0.0197:  80%|█████████▌  | 36/45 [06:11<01:29,  9.96s/it]Epoch: 37 | Train Loss: 0.0044 | Val Loss: 0.0197:  82%|█████████▊  | 37/45 [06:11<01:19,  9.99s/it]Epoch: 38 | Train Loss: 0.0044 | Val Loss: 0.0197:  82%|█████████▊  | 37/45 [06:20<01:19,  9.99s/it]Epoch: 38 | Train Loss: 0.0044 | Val Loss: 0.0197:  84%|██████████▏ | 38/45 [06:20<01:09,  9.97s/it]Epoch: 39 | Train Loss: 0.0042 | Val Loss: 0.0195:  84%|██████████▏ | 38/45 [06:30<01:09,  9.97s/it]Epoch: 39 | Train Loss: 0.0042 | Val Loss: 0.0195:  87%|██████████▍ | 39/45 [06:30<00:59,  9.99s/it]Epoch: 40 | Train Loss: 0.0040 | Val Loss: 0.0196:  87%|██████████▍ | 39/45 [06:40<00:59,  9.99s/it]Epoch: 40 | Train Loss: 0.0040 | Val Loss: 0.0196:  89%|██████████▋ | 40/45 [06:40<00:49,  9.99s/it]Epoch: 41 | Train Loss: 0.0037 | Val Loss: 0.0195:  89%|██████████▋ | 40/45 [06:51<00:49,  9.99s/it]Epoch: 41 | Train Loss: 0.0037 | Val Loss: 0.0195:  91%|██████████▉ | 41/45 [06:51<00:40, 10.02s/it]Epoch: 42 | Train Loss: 0.0040 | Val Loss: 0.0196:  91%|██████████▉ | 41/45 [07:01<00:40, 10.02s/it]Epoch: 42 | Train Loss: 0.0040 | Val Loss: 0.0196:  93%|███████████▏| 42/45 [07:01<00:30, 10.02s/it]Epoch: 43 | Train Loss: 0.0043 | Val Loss: 0.0199:  93%|███████████▏| 42/45 [07:11<00:30, 10.02s/it]Epoch: 43 | Train Loss: 0.0043 | Val Loss: 0.0199:  96%|███████████▍| 43/45 [07:11<00:19, 10.00s/it]Epoch: 44 | Train Loss: 0.0039 | Val Loss: 0.0191:  96%|███████████▍| 43/45 [07:21<00:19, 10.00s/it]Epoch: 44 | Train Loss: 0.0039 | Val Loss: 0.0191:  98%|███████████▋| 44/45 [07:21<00:09,  9.99s/it]Epoch: 45 | Train Loss: 0.0038 | Val Loss: 0.0192:  98%|███████████▋| 44/45 [07:30<00:09,  9.99s/it]Epoch: 45 | Train Loss: 0.0038 | Val Loss: 0.0192: 100%|████████████| 45/45 [07:30<00:00,  9.97s/it]Epoch: 45 | Train Loss: 0.0038 | Val Loss: 0.0192: 100%|████████████| 45/45 [07:30<00:00, 10.02s/it]
2023-12-15 21:03:53,564 - root - INFO - Training finished.
2023-12-15 21:03:53,564 - root - INFO - Testing model...
2023-12-15 21:03:53,980 - root - INFO - Test loss: 0.018761951010674238, Test r_square: 0.7692608833312988
2023-12-15 21:03:53,980 - root - INFO - Testing finished.
2023-12-15 21:03:53,980 - root - INFO - saving model...
2023-12-15 21:03:54,004 - root - INFO - model saved.
2023-12-15 21:03:54,004 - root - INFO - saving results
2023-12-15 21:03:54,007 - root - INFO - results saved.
